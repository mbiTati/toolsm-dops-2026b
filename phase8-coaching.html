<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phase 8 - Module Coach | SuPrealty Guide</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>:root{--bg-dark:#0a0f1a;--bg-card:#111827;--accent-primary:#6366f1;--accent-secondary:#22d3ee;--accent-success:#10b981;--accent-warning:#f59e0b;--accent-coach:#d946ef;--text-primary:#f1f5f9;--text-secondary:#94a3b8;--text-muted:#64748b;--border:#1e293b;--gradient-primary:linear-gradient(135deg,#6366f1,#8b5cf6,#d946ef);--gradient-coach:linear-gradient(135deg,#d946ef,#8b5cf6)}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:var(--bg-dark);color:var(--text-primary);min-height:100vh;line-height:1.6}.header{background:var(--bg-card);border-bottom:1px solid var(--border);padding:16px 24px;position:sticky;top:0;z-index:100;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px}.header-left{display:flex;align-items:center;gap:16px}.back-btn{background:rgba(217,70,239,0.1);border:1px solid rgba(217,70,239,0.3);color:var(--accent-coach);padding:8px 16px;border-radius:8px;text-decoration:none}.header-title{font-size:1.25rem;font-weight:700}.header-title span{color:var(--text-muted)}.header-progress-bar{width:200px;height:8px;background:var(--border);border-radius:999px;overflow:hidden}.header-progress-fill{height:100%;background:var(--gradient-coach)}.content{max-width:900px;margin:0 auto;padding:32px}.content-header{margin-bottom:32px}.content-phase{display:inline-block;background:var(--gradient-coach);color:white;padding:4px 12px;border-radius:999px;font-size:0.8rem;font-weight:600;margin-bottom:12px}.content-title{font-size:2rem;font-weight:800;margin-bottom:8px}.content-subtitle{color:var(--text-secondary)}.step{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;margin-bottom:16px;overflow:hidden}.step.completed{border-color:rgba(16,185,129,0.3)}.step.open{border-color:rgba(217,70,239,0.3)}.step-header{padding:20px 24px;display:flex;align-items:center;justify-content:space-between;cursor:pointer}.step-header:hover{background:rgba(217,70,239,0.05)}.step-header-left{display:flex;align-items:center;gap:16px}.step-number{width:40px;height:40px;background:linear-gradient(135deg,rgba(217,70,239,0.2),rgba(139,92,246,0.1));border:1px solid rgba(217,70,239,0.3);border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent-coach)}.step.completed .step-number{background:linear-gradient(135deg,rgba(16,185,129,0.2),rgba(34,211,238,0.1));border-color:rgba(16,185,129,0.3);color:var(--accent-success)}.step-info h3{font-size:1rem;font-weight:600;margin-bottom:4px}.step-info p{font-size:0.85rem;color:var(--text-muted)}.step-header-right{display:flex;align-items:center;gap:12px}.step-duration{font-size:0.8rem;color:var(--text-muted);background:var(--border);padding:4px 10px;border-radius:999px}.step-checkbox{width:24px;height:24px;border:2px solid #334155;border-radius:6px;cursor:pointer}.step-checkbox.checked{background:var(--accent-success);border-color:var(--accent-success)}.step-checkbox.checked::after{content:'‚úì';color:white;font-weight:700;display:flex;align-items:center;justify-content:center}.step-toggle{color:var(--text-muted)}.step.open .step-toggle{transform:rotate(180deg)}.step-body{display:none;padding:0 24px 24px;border-top:1px solid var(--border)}.step.open .step-body{display:block}.instruction{margin-top:20px}.instruction-title{font-size:0.9rem;font-weight:600;color:var(--accent-coach);margin-bottom:12px}.code-block{background:#0d1117;border:1px solid var(--border);border-radius:12px;margin:12px 0;overflow:hidden}.code-header{background:var(--border);padding:10px 16px;font-size:0.8rem;color:var(--text-muted);font-family:'JetBrains Mono',monospace}.code-content{padding:16px;font-family:'JetBrains Mono',monospace;font-size:0.85rem;color:#e2e8f0;white-space:pre-wrap}.tip{background:linear-gradient(135deg,rgba(217,70,239,0.1),rgba(139,92,246,0.05));border:1px solid rgba(217,70,239,0.2);border-radius:12px;padding:16px 20px;margin:16px 0;display:flex;gap:12px}.tip-content{font-size:0.9rem;color:var(--text-secondary)}.tip-content strong{color:var(--accent-coach)}.page-nav{display:flex;justify-content:space-between;margin-top:40px;padding-top:24px;border-top:1px solid var(--border);gap:16px;flex-wrap:wrap}.page-nav-btn{display:flex;align-items:center;gap:12px;padding:16px 24px;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;text-decoration:none;color:var(--text-primary)}.page-nav-btn:hover{border-color:var(--accent-coach)}.page-nav-label{font-size:0.8rem;color:var(--text-muted)}.page-nav-title{font-weight:600}</style>
</head>
<body>
  <header class="header">
    <div class="header-left"><a href="index.html" class="back-btn">‚Üê Retour</a><div class="header-title">Phase 8 <span>/ Module Coach</span></div></div>
    <div style="display:flex;align-items:center;gap:12px"><span id="progress-text" style="font-size:0.9rem;color:var(--text-secondary)">0/14</span><div class="header-progress-bar"><div class="header-progress-fill" id="progress-fill" style="width:0%"></div></div></div>
  </header>
  <main class="content">
    <div class="content-header"><div class="content-phase">Phase 8 sur 10</div><h1 class="content-title">Module Coach</h1><p class="content-subtitle">Interface d√©di√©e aux coachs : gestion des coach√©s, suivi de progression, et outils p√©dagogiques.</p></div>
    <div id="steps-container">
      
      <article class="step open" data-step="1"><div class="step-header"><div class="step-header-left"><div class="step-number">1</div><div class="step-info"><h3>Condition d'acc√®s profil Coach</h3><p>Visible uniquement si profil_id = 3</p></div></div><div class="step-header-right"><span class="step-duration">~5 min</span><div class="step-checkbox" data-step="1"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Condition d'affichage</div><div class="code-block"><div class="code-header">Sur le lien sidebar + la page</div><div class="code-content">// Condition d'affichage
{{userProfile.profil_id === 3}}

// Redirection si acc√®s direct non autoris√©
// Dans le workflow On Page Load
if (userProfile.profil_id !== 3) {
  Navigate to /dashboard
}</div></div></div></div></article>

      <article class="step" data-step="2"><div class="step-header"><div class="step-header-left"><div class="step-number">2</div><div class="step-info"><h3>Dashboard Coach</h3><p>Vue d'ensemble des coach√©s</p></div></div><div class="step-header-right"><span class="step-duration">~15 min</span><div class="step-checkbox" data-step="2"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">KPI Coach</div><div class="code-block"><div class="code-header">M√©triques</div><div class="code-content">// Collection coach√©s
Table: agents
Filter: coach_id = {{user.id}}

// KPI
- Nombre de coach√©s actifs
- S√©ances ce mois
- Taux de progression moyen
- Prochaine s√©ance</div></div></div></div></article>

      <article class="step" data-step="3"><div class="step-header"><div class="step-header-left"><div class="step-number">3</div><div class="step-info"><h3>Liste des coach√©s</h3><p>Tous les agents suivis</p></div></div><div class="step-header-right"><span class="step-duration">~15 min</span><div class="step-checkbox" data-step="3"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Collection</div><div class="code-block"><div class="code-header">Requ√™te</div><div class="code-content">Table: agents
Filter: coach_id = {{user.id}}
Select: *, programmes_coaching(*)</div></div></div></div></article>

      <article class="step" data-step="4"><div class="step-header"><div class="step-header-left"><div class="step-number">4</div><div class="step-info"><h3>Fiche coach√©</h3><p>D√©tail et progression</p></div></div><div class="step-header-right"><span class="step-duration">~20 min</span><div class="step-checkbox" data-step="4"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Sections</div><div class="code-block"><div class="code-header">Structure fiche</div><div class="code-content">// Infos personnelles
Nom, email, t√©l√©phone, date inscription

// Stats activit√© (de l'agent)
Nb vendeurs, Nb mandats, CA, Taux conversion

// Programme en cours
Module actuel, progression %

// Historique s√©ances
// Notes du coach
// Objectifs d√©finis</div></div></div></div></article>

      <article class="step" data-step="5"><div class="step-header"><div class="step-header-left"><div class="step-number">5</div><div class="step-info"><h3>Programmes de coaching</h3><p>D√©finir les parcours</p></div></div><div class="step-header-right"><span class="step-duration">~20 min</span><div class="step-checkbox" data-step="5"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Structure programme</div><div class="code-block"><div class="code-header">Table programmes_coaching</div><div class="code-content">{
  "coach_id": "{{user.id}}",
  "titre": "M√©thode ARCHI - Niveau 1",
  "description": "Fondamentaux du m√©tier",
  "duree_semaines": 8,
  "nb_modules": 5,
  "modules": [
    { "ordre": 1, "titre": "Mindset", "duree_heures": 4 },
    { "ordre": 2, "titre": "Prospection", "duree_heures": 6 },
    { "ordre": 3, "titre": "Estimation", "duree_heures": 4 },
    { "ordre": 4, "titre": "N√©gociation", "duree_heures": 6 },
    { "ordre": 5, "titre": "Closing", "duree_heures": 4 }
  ]
}</div></div></div></div></article>

      <article class="step" data-step="6"><div class="step-header"><div class="step-header-left"><div class="step-number">6</div><div class="step-info"><h3>Assigner un programme</h3><p>Lier coach√© √† un programme</p></div></div><div class="step-header-right"><span class="step-duration">~10 min</span><div class="step-checkbox" data-step="6"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Workflow</div><div class="code-block"><div class="code-header">Assignation</div><div class="code-content">INSERT INTO inscriptions_programme {
  "agent_id": "{{coachedId}}",
  "programme_id": "{{programmeId}}",
  "coach_id": "{{user.id}}",
  "date_debut": "{{formDateDebut}}",
  "statut": "en_cours",
  "module_actuel": 1,
  "progression": 0
}</div></div></div></div></article>

      <article class="step" data-step="7"><div class="step-header"><div class="step-header-left"><div class="step-number">7</div><div class="step-info"><h3>Planifier une s√©ance</h3><p>RDV de coaching</p></div></div><div class="step-header-right"><span class="step-duration">~15 min</span><div class="step-checkbox" data-step="7"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Insert s√©ance</div><div class="code-block"><div class="code-header">Formulaire</div><div class="code-content">{
  "coach_id": "{{user.id}}",
  "agent_id": "{{coachedId}}",
  "date_seance": "{{formDate}}",
  "heure_seance": "{{formHeure}}",
  "duree_minutes": {{formDuree}},
  "type_seance": "{{formType}}", // individuel, groupe, visio
  "sujet": "{{formSujet}}",
  "statut_seance": "planifiee"
}</div></div></div></div></article>

      <article class="step" data-step="8"><div class="step-header"><div class="step-header-left"><div class="step-number">8</div><div class="step-info"><h3>Compte-rendu s√©ance</h3><p>Notes et progression</p></div></div><div class="step-header-right"><span class="step-duration">~15 min</span><div class="step-checkbox" data-step="8"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Update s√©ance</div><div class="code-block"><div class="code-header">Apr√®s la s√©ance</div><div class="code-content">UPDATE seances_coaching SET
  statut_seance = 'effectuee',
  notes_coach = '{{formNotes}}',
  points_abordes = '{{formPoints}}',
  objectifs_prochaine = '{{formObjectifs}}',
  progression_module = {{formProgression}} // 0-100
WHERE id = {{seanceId}}

// Si module termin√©, mettre √† jour l'inscription
UPDATE inscriptions_programme SET
  module_actuel = module_actuel + 1,
  progression = (module_actuel / nb_modules) * 100
WHERE agent_id = {{coachedId}}</div></div></div></div></article>

      <article class="step" data-step="9"><div class="step-header"><div class="step-header-left"><div class="step-number">9</div><div class="step-info"><h3>Suivi de progression</h3><p>Graphiques et indicateurs</p></div></div><div class="step-header-right"><span class="step-duration">~15 min</span><div class="step-checkbox" data-step="9"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Visualisation</div><div class="code-block"><div class="code-header">KPI coach√©</div><div class="code-content">// Barre de progression programme
{{inscription.progression}}%

// √âvolution CA (comparaison avant/apr√®s coaching)
// Nombre de mandats par mois
// Taux de conversion estimation ‚Üí mandat

// Graphique : utiliser un composant Chart WeWeb</div></div></div></div></article>

      <article class="step" data-step="10"><div class="step-header"><div class="step-header-left"><div class="step-number">10</div><div class="step-info"><h3>Ressources p√©dagogiques</h3><p>Documents et vid√©os</p></div></div><div class="step-header-right"><span class="step-duration">~15 min</span><div class="step-checkbox" data-step="10"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Biblioth√®que</div><div class="code-block"><div class="code-header">Structure</div><div class="code-content">Table: ressources_coaching
{
  "coach_id": "{{user.id}}",
  "titre": "Script d'appel prospection",
  "type": "document", // video, document, exercice
  "url": "{{fileUrl}}",
  "module_id": {{moduleId}},
  "acces": "coach√©s" // ou "public"
}</div></div></div><div class="tip"><span style="font-size:1.25rem">üìö</span><div class="tip-content"><strong>Stockage :</strong> Utilise Supabase Storage pour les fichiers, ou des liens YouTube/Vimeo pour les vid√©os.</div></div></div></article>

      <article class="step" data-step="11"><div class="step-header"><div class="step-header-left"><div class="step-number">11</div><div class="step-info"><h3>Objectifs et challenges</h3><p>D√©finir des objectifs</p></div></div><div class="step-header-right"><span class="step-duration">~15 min</span><div class="step-checkbox" data-step="11"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Suivi objectifs</div><div class="code-block"><div class="code-header">Table objectifs</div><div class="code-content">{
  "agent_id": "{{coachedId}}",
  "coach_id": "{{user.id}}",
  "titre": "10 estimations ce mois",
  "type": "mensuel",
  "metrique": "nb_estimations",
  "valeur_cible": 10,
  "valeur_actuelle": 0, // calcul√© dynamiquement
  "date_limite": "2026-03-31",
  "statut": "en_cours"
}</div></div></div></div></article>

      <article class="step" data-step="12"><div class="step-header"><div class="step-header-left"><div class="step-number">12</div><div class="step-info"><h3>Messagerie coach/coach√©</h3><p>Chat interne</p></div></div><div class="step-header-right"><span class="step-duration">~15 min</span><div class="step-checkbox" data-step="12"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="tip"><span style="font-size:1.25rem">üí¨</span><div class="tip-content"><strong>Option simple :</strong> Section "Notes" sur la fiche coach√©. <strong>Option avanc√©e :</strong> Chat temps r√©el avec Supabase Realtime.</div></div></div></article>

      <article class="step" data-step="13"><div class="step-header"><div class="step-header-left"><div class="step-number">13</div><div class="step-info"><h3>Rapports mensuels</h3><p>Export stats coach√©</p></div></div><div class="step-header-right"><span class="step-duration">~10 min</span><div class="step-checkbox" data-step="13"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">G√©n√©ration rapport</div><div class="code-block"><div class="code-header">Donn√©es √† inclure</div><div class="code-content">- Activit√© du mois (RDV, mandats, ventes)
- Progression dans le programme
- Objectifs atteints / en cours
- S√©ances effectu√©es
- Recommandations coach</div></div></div></div></article>

      <article class="step" data-step="14"><div class="step-header"><div class="step-header-left"><div class="step-number">14</div><div class="step-info"><h3>Tester le module Coach</h3><p>Checklist finale</p></div></div><div class="step-header-right"><span class="step-duration">~10 min</span><div class="step-checkbox" data-step="14"></div><div class="step-toggle">‚ñº</div></div></div><div class="step-body"><div class="instruction"><div class="instruction-title">Checklist</div><ul style="list-style:none;color:var(--text-secondary)"><li style="padding:8px 0">‚óã Acc√®s r√©serv√© aux profils Coach</li><li style="padding:8px 0">‚óã Liste des coach√©s s'affiche</li><li style="padding:8px 0">‚óã Cr√©er/assigner un programme</li><li style="padding:8px 0">‚óã Planifier une s√©ance</li><li style="padding:8px 0">‚óã Remplir un compte-rendu</li><li style="padding:8px 0">‚óã La progression se met √† jour</li></ul></div><div class="tip"><span style="font-size:1.25rem">üéâ</span><div class="tip-content"><strong>Phase 8 termin√©e !</strong> Le module Coach est op√©rationnel.</div></div></div></article>

    </div>
    <nav class="page-nav"><a href="phase7-planning.html" class="page-nav-btn"><span>‚Üê</span><div><div class="page-nav-label">Pr√©c√©dent</div><div class="page-nav-title">Phase 7</div></div></a><a href="phase9-mdb.html" class="page-nav-btn"><div style="text-align:right"><div class="page-nav-label">Suivant</div><div class="page-nav-title">Phase 9</div></div><span>‚Üí</span></a></nav>
  </main>
  <script>const STORAGE_KEY='suprealty_progress',PHASE_ID='phase8',TOTAL_STEPS=14;function loadProgress(){try{return JSON.parse(localStorage.getItem(STORAGE_KEY)||'{}')}catch{return{}}}function saveProgress(p){localStorage.setItem(STORAGE_KEY,JSON.stringify(p))}function updateUI(){const progress=loadProgress(),pp=progress[PHASE_ID]||{steps:{}},count=Object.values(pp.steps||{}).filter(Boolean).length;document.getElementById('progress-text').textContent=count+'/'+TOTAL_STEPS;document.getElementById('progress-fill').style.width=(count/TOTAL_STEPS*100)+'%';document.querySelectorAll('.step').forEach(s=>{const n=s.dataset.step,done=pp.steps&&pp.steps[n],cb=s.querySelector('.step-checkbox');done?(s.classList.add('completed'),cb&&cb.classList.add('checked')):(s.classList.remove('completed'),cb&&cb.classList.remove('checked'))})}function toggleStep(el){document.querySelectorAll('.step.open').forEach(s=>{if(s!==el)s.classList.remove('open')});el.classList.toggle('open')}function toggleCheckbox(n){const p=loadProgress();if(!p[PHASE_ID])p[PHASE_ID]={steps:{}};p[PHASE_ID].steps[n]=!p[PHASE_ID].steps[n];saveProgress(p);updateUI()}document.querySelectorAll('.step-header').forEach(h=>{h.addEventListener('click',e=>{if(!e.target.closest('.step-checkbox'))toggleStep(h.closest('.step'))})});document.querySelectorAll('.step-checkbox').forEach(c=>{c.addEventListener('click',e=>{e.stopPropagation();toggleCheckbox(c.dataset.step)})});updateUI();</script>
</body>
</html>
}.header-progress{display:flex;align-items:center;gap:12px}.header-progress-text{font-size:0.9rem;color:var(--text-secondary)}.header-progress-bar{width:200px;height:8px;background:var(--border);border-radius:999px;overflow:hidden}.header-progress-fill{height:100%;background:linear-gradient(135deg,#10b981,#22d3ee);transition:width 0.3s}
    .main-layout{display:grid;grid-template-columns:280px 1fr;min-height:calc(100vh - 65px)}@media(max-width:1024px){.main-layout{grid-template-columns:1fr}.sidebar{display:none}}
    .sidebar{background:var(--bg-card);border-right:1px solid var(--border);padding:24px;position:sticky;top:65px;height:calc(100vh - 65px);overflow-y:auto}.sidebar-title{font-size:0.75rem;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-muted);margin-bottom:12px}.sidebar-nav{list-style:none}.sidebar-nav-item{padding:10px 12px;border-radius:8px;margin-bottom:4px;cursor:pointer;display:flex;align-items:center;gap:10px;font-size:0.9rem;color:var(--text-secondary)}.sidebar-nav-item:hover{background:rgba(99,102,241,0.1)}.sidebar-nav-item.completed{color:var(--accent-success)}.sidebar-nav-number{width:24px;height:24px;background:var(--border);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:0.75rem;font-weight:600}.sidebar-nav-item.completed .sidebar-nav-number{background:rgba(16,185,129,0.2);color:var(--accent-success)}
    .content{padding:32px;max-width:900px}.content-header{margin-bottom:32px}.content-phase{display:inline-block;background:var(--gradient-primary);color:white;padding:4px 12px;border-radius:999px;font-size:0.8rem;font-weight:600;margin-bottom:12px}.content-title{font-size:2rem;font-weight:800;margin-bottom:8px}.content-subtitle{font-size:1.1rem;color:var(--text-secondary)}
    .step{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:16px;overflow:hidden}.step.completed{border-color:rgba(16,185,129,0.3)}.step.open{border-color:rgba(99,102,241,0.3)}.step-header{padding:20px 24px;display:flex;align-items:center;justify-content:space-between;cursor:pointer}.step-header:hover{background:rgba(99,102,241,0.05)}.step-header-left{display:flex;align-items:center;gap:16px}.step-number{width:40px;height:40px;background:linear-gradient(135deg,rgba(99,102,241,0.2),rgba(139,92,246,0.1));border:1px solid rgba(99,102,241,0.3);border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent-primary)}.step.completed .step-number{background:linear-gradient(135deg,rgba(16,185,129,0.2),rgba(34,211,238,0.1));border-color:rgba(16,185,129,0.3);color:var(--accent-success)}.step-info h3{font-size:1rem;font-weight:600;margin-bottom:4px}.step-info p{font-size:0.85rem;color:var(--text-muted)}.step-header-right{display:flex;align-items:center;gap:12px}.step-duration{font-size:0.8rem;color:var(--text-muted);background:var(--border);padding:4px 10px;border-radius:999px}.step-checkbox{width:24px;height:24px;border:2px solid #334155;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center}.step-checkbox.checked{background:var(--accent-success);border-color:var(--accent-success)}.step-checkbox.checked::after{content:'‚úì';color:white;font-weight:700}.step-toggle{width:24px;height:24px;display:flex;align-items:center;justify-content:center;color:var(--text-muted);transition:transform 0.3s}.step.open .step-toggle{transform:rotate(180deg)}.step-body{display:none;padding:0 24px 24px;border-top:1px solid var(--border)}.step.open .step-body{display:block}
    .instruction{margin-top:20px}.instruction-title{font-size:0.9rem;font-weight:600;color:var(--accent-secondary);margin-bottom:12px;display:flex;align-items:center;gap:8px}.instruction-title::before{content:'';width:4px;height:16px;background:var(--accent-secondary);border-radius:2px}
    .tip{background:linear-gradient(135deg,rgba(16,185,129,0.1),rgba(34,211,238,0.05));border:1px solid rgba(16,185,129,0.2);border-radius:12px;padding:16px 20px;margin:16px 0;display:flex;gap:12px}.tip-icon{font-size:1.25rem}.tip-content{font-size:0.9rem;color:var(--text-secondary)}.tip-content strong{color:var(--accent-success)}
    .warning{background:linear-gradient(135deg,rgba(245,158,11,0.1),rgba(239,68,68,0.05));border:1px solid rgba(245,158,11,0.2);border-radius:12px;padding:16px 20px;margin:16px 0;display:flex;gap:12px}.warning-content{font-size:0.9rem;color:var(--text-secondary)}.warning-content strong{color:var(--accent-warning)}
    .code-block{background:var(--bg-code);border:1px solid var(--border);border-radius:12px;margin:12px 0;overflow:hidden}.code-header{background:var(--border);padding:10px 16px}.code-label{font-size:0.8rem;color:var(--text-muted);font-family:'JetBrains Mono',monospace}.code-content{padding:16px;font-family:'JetBrains Mono',monospace;font-size:0.85rem;line-height:1.7;color:#e2e8f0;white-space:pre-wrap}
    .page-nav{display:flex;justify-content:space-between;margin-top:40px;padding-top:24px;border-top:1px solid var(--border);gap:16px;flex-wrap:wrap}.page-nav-btn{display:flex;align-items:center;gap:12px;padding:16px 24px;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;text-decoration:none;color:var(--text-primary)}.page-nav-btn:hover{border-color:var(--accent-primary)}.page-nav-label{font-size:0.8rem;color:var(--text-muted)}.page-nav-title{font-weight:600}
  </style>
</head>
<body>
  <header class="header">
    <div class="header-left">
      <a href="index.html" class="back-btn">‚Üê Retour</a>
      <div class="header-title">Phase 8 <span>/ Module Coach</span></div>
    </div>
    <div class="header-progress">
      <span class="header-progress-text" id="progress-text">0/14 √©tapes</span>
      <div class="header-progress-bar"><div class="header-progress-fill" id="progress-fill" style="width:0%"></div></div>
    </div>
  </header>

  <div class="main-layout">
    <aside class="sidebar">
      <div class="sidebar-title">√âtapes Phase 8</div>
      <ul class="sidebar-nav" id="sidebar-nav"></ul>
    </aside>

    <main class="content">
      <div class="content-header">
        <div class="content-phase">Phase 8 sur 10</div>
        <h1 class="content-title">Module Coach</h1>
        <p class="content-subtitle">Fonctionnalit√©s r√©serv√©es aux coachs : gestion d'√©quipe, suivi des coach√©s, et analytics.</p>
      </div>

      <div id="steps-container">

        <article class="step open" data-step="1">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">1</div>
              <div class="step-info"><h3>V√©rifier le profil Coach</h3><p>Condition d'acc√®s au module</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~5 min</span>
              <div class="step-checkbox" data-step="1"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Condition d'affichage</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Acc√®s conditionnel</span></div>
                <div class="code-content">// Dans la sidebar, lien "Coaching" visible si :
{{userProfile.profil_id === 3}}

// Page /coaching prot√©g√©e par :
// Workflow On Page Load ‚Üí if profil_id !== 3 ‚Üí Navigate to /dashboard</div>
              </div>
            </div>
            <div class="warning">
              <span class="tip-icon">‚ö†Ô∏è</span>
              <div class="warning-content"><strong>Important :</strong> Cette protection c√¥t√© frontend est compl√©t√©e par le RLS Supabase qui emp√™che l'acc√®s aux donn√©es des autres agents.</div>
            </div>
          </div>
        </article>

        <article class="step" data-step="2">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">2</div>
              <div class="step-info"><h3>Dashboard Coach</h3><p>Vue d'ensemble de l'√©quipe</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~20 min</span>
              <div class="step-checkbox" data-step="2"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">KPI globaux</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">M√©triques √©quipe</span></div>
                <div class="code-content">// Nombre de coach√©s
{{coaches.data.length}}

// Ventes totales √©quipe ce mois
{{ventesEquipe.data.filter(v => 
  new Date(v.date_signature_acte).getMonth() === new Date().getMonth()
).length}}

// CA total √©quipe
{{ventesEquipe.data.reduce((sum, v) => sum + v.honoraires_agent, 0).toLocaleString()}} ‚Ç¨

// Moyenne par agent
{{(caTotal / nbAgents).toLocaleString()}} ‚Ç¨</div>
              </div>
            </div>
          </div>
        </article>

        <article class="step" data-step="3">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">3</div>
              <div class="step-info"><h3>Liste des coach√©s</h3><p>Agents sous ta responsabilit√©</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~15 min</span>
              <div class="step-checkbox" data-step="3"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Collection coach√©s</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Requ√™te Supabase</span></div>
                <div class="code-content">// Table agents avec lien vers coach
Table: agents
Filter: coach_id = {{user.id}}
Select: *, profils(nom_profil)</div>
              </div>
            </div>
            <div class="instruction">
              <div class="instruction-title">Infos affich√©es par coach√©</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Carte agent</span></div>
                <div class="code-content">- Nom, pr√©nom, photo
- Date d'arriv√©e
- Nb vendeurs actifs
- Nb ventes ce mois
- CA ce mois
- Dernier contact avec le coach</div>
              </div>
            </div>
          </div>
        </article>

        <article class="step" data-step="4">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">4</div>
              <div class="step-info"><h3>Fiche coach√© d√©taill√©e</h3><p>Performance individuelle</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~20 min</span>
              <div class="step-checkbox" data-step="4"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Sections de la fiche</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Contenu</span></div>
                <div class="code-content">// INFOS G√âN√âRALES
Profil, contact, date arriv√©e

// KPI
- Pipeline (nb affaires par √©tape)
- Taux de conversion
- CA mensuel/annuel
- √âvolution vs mois pr√©c√©dent

// ACTIVIT√â
- Nb appels/semaine (si track√©)
- Nb RDV/semaine
- Nb visites/semaine

// HISTORIQUE COACHING
- Notes des s√©ances pr√©c√©dentes
- Objectifs fix√©s et atteints
- Points d'attention</div>
              </div>
            </div>
          </div>
        </article>

        <article class="step" data-step="5">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">5</div>
              <div class="step-info"><h3>S√©ances de coaching</h3><p>Planifier et documenter</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~20 min</span>
              <div class="step-checkbox" data-step="5"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Table seances_coaching</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Structure</span></div>
                <div class="code-content">{
  "id": uuid,
  "coach_id": uuid,
  "agent_id": uuid,
  "date_seance": date,
  "duree_minutes": integer,
  "type_seance": text, // individuelle, collective, terrain
  "objectifs_seance": text,
  "points_abordes": text,
  "actions_definies": text,
  "notes_coach": text,
  "prochaine_seance": date
}</div>
              </div>
            </div>
          </div>
        </article>

        <article class="step" data-step="6">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">6</div>
              <div class="step-info"><h3>Objectifs et suivi</h3><p>Fixer et tracker les objectifs</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~15 min</span>
              <div class="step-checkbox" data-step="6"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Table objectifs</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Structure</span></div>
                <div class="code-content">{
  "agent_id": uuid,
  "periode": text, // mensuel, trimestriel, annuel
  "type_objectif": text, // ca, ventes, mandats, rdv
  "valeur_cible": number,
  "valeur_actuelle": number, // calcul√© ou mis √† jour
  "date_debut": date,
  "date_fin": date
}</div>
              </div>
            </div>
            <div class="instruction">
              <div class="instruction-title">Affichage progression</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Barre de progression</span></div>
                <div class="code-content">// Pourcentage
{{Math.round((valeur_actuelle / valeur_cible) * 100)}}%

// Largeur barre
width: {{Math.min(100, (valeur_actuelle / valeur_cible) * 100)}}%

// Couleur
{{progression >= 100 ? '#10b981' :
  progression >= 75 ? '#22d3ee' :
  progression >= 50 ? '#f59e0b' :
  '#ef4444'}}</div>
              </div>
            </div>
          </div>
        </article>

        <article class="step" data-step="7">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">7</div>
              <div class="step-info"><h3>Classement √©quipe</h3><p>Leaderboard motivant</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~15 min</span>
              <div class="step-checkbox" data-step="7"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Classement par CA</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Tri des agents</span></div>
                <div class="code-content">{{coaches.data.map(agent => ({
  ...agent,
  caMois: ventesEquipe.data
    .filter(v => v.agent_id === agent.id && 
      new Date(v.date_signature_acte).getMonth() === new Date().getMonth())
    .reduce((sum, v) => sum + v.honoraires_agent, 0)
})).sort((a, b) => b.caMois - a.caMois)}}</div>
              </div>
            </div>
            <div class="tip">
              <span class="tip-icon">üèÜ</span>
              <div class="tip-content"><strong>Gamification :</strong> Ajoute des badges (ü•áü•àü•â) aux 3 premiers du classement !</div>
            </div>
          </div>
        </article>

        <article class="step" data-step="8">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">8</div>
              <div class="step-info"><h3>Analytics avanc√©es</h3><p>Graphiques et tendances</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~25 min</span>
              <div class="step-checkbox" data-step="8"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Graphiques utiles</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Visualisations</span></div>
                <div class="code-content">1. √âvolution CA √©quipe (line chart par mois)
2. R√©partition par agent (pie chart)
3. Taux de conversion par √©tape (funnel)
4. Comparaison objectifs vs r√©alis√© (bar chart)
5. Activit√© par jour de la semaine (heatmap)</div>
              </div>
            </div>
            <div class="tip">
              <span class="tip-icon">üí°</span>
              <div class="tip-content"><strong>Librairies :</strong> Utilise Chart.js ou Recharts (si React) pour les graphiques.</div>
            </div>
          </div>
        </article>

        <article class="step" data-step="9">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">9</div>
              <div class="step-info"><h3>Alertes coach</h3><p>Agents en difficult√©</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~15 min</span>
              <div class="step-checkbox" data-step="9"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">D√©tection automatique</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Agents √† risque</span></div>
                <div class="code-content">// Agents sans vente depuis X jours
{{coaches.data.filter(agent => {
  const lastVente = ventesEquipe.data
    .filter(v => v.agent_id === agent.id)
    .sort((a, b) => new Date(b.date_signature_acte) - new Date(a.date_signature_acte))[0];
  
  if (!lastVente) return true; // Jamais vendu
  
  const daysSinceVente = Math.ceil(
    (new Date() - new Date(lastVente.date_signature_acte)) / (1000*60*60*24)
  );
  return daysSinceVente > 60; // Plus de 2 mois
})}}</div>
              </div>
            </div>
          </div>
        </article>

        <article class="step" data-step="10">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">10</div>
              <div class="step-info"><h3>Ressources partag√©es</h3><p>Documents pour l'√©quipe</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~15 min</span>
              <div class="step-checkbox" data-step="10"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Biblioth√®que de ressources</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Table ressources</span></div>
                <div class="code-content">{
  "coach_id": uuid,
  "titre": text,
  "description": text,
  "categorie": text, // prospection, negociation, juridique, mindset
  "type_fichier": text, // pdf, video, lien
  "url_fichier": text,
  "visible_par": text[] // all, ou liste d'agent_ids
}</div>
              </div>
            </div>
          </div>
        </article>

        <article class="step" data-step="11">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">11</div>
              <div class="step-info"><h3>Messagerie interne</h3><p>Communication avec l'√©quipe</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~20 min</span>
              <div class="step-checkbox" data-step="11"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Option simple</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">Annonces</span></div>
                <div class="code-content">// Table annonces
{
  "coach_id": uuid,
  "titre": text,
  "contenu": text,
  "date_publication": timestamp,
  "priorite": text // normale, importante, urgente
}

// Visible sur le dashboard des coach√©s</div>
              </div>
            </div>
            <div class="tip">
              <span class="tip-icon">üí°</span>
              <div class="tip-content"><strong>Alternative :</strong> Int√©grer avec Slack ou WhatsApp plut√¥t que recr√©er une messagerie compl√®te.</div>
            </div>
          </div>
        </article>

        <article class="step" data-step="12">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">12</div>
              <div class="step-info"><h3>Export rapports</h3><p>Rapports PDF/Excel</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~15 min</span>
              <div class="step-checkbox" data-step="12"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Export CSV simplifi√©</div>
              <div class="code-block">
                <div class="code-header"><span class="code-label">G√©n√©rer rapport</span></div>
                <div class="code-content">// M√™me logique que l'export vendeurs
// Donn√©es : agent, ventes, CA, objectifs, progression</div>
              </div>
            </div>
          </div>
        </article>

        <article class="step" data-step="13">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">13</div>
              <div class="step-info"><h3>Responsive mobile</h3><p>Acc√®s mobile pour le coach</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~15 min</span>
              <div class="step-checkbox" data-step="13"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Priorit√©s mobile</div>
              <p style="color:var(--text-secondary);margin:12px 0;">Sur mobile, focus sur : liste coach√©s, KPI rapides, alertes. Les graphiques complexes sont mieux sur desktop.</p>
            </div>
          </div>
        </article>

        <article class="step" data-step="14">
          <div class="step-header">
            <div class="step-header-left">
              <div class="step-number">14</div>
              <div class="step-info"><h3>Tester le module Coach</h3><p>Validation</p></div>
            </div>
            <div class="step-header-right">
              <span class="step-duration">~10 min</span>
              <div class="step-checkbox" data-step="14"></div>
              <div class="step-toggle">‚ñº</div>
            </div>
          </div>
          <div class="step-body">
            <div class="instruction">
              <div class="instruction-title">Checklist</div>
              <ul style="list-style:none;margin:16px 0;">
                <li style="padding:8px 0;">‚óã Acc√®s r√©serv√© aux profil_id = 3</li>
                <li style="padding:8px 0;">‚óã Liste des coach√©s affich√©e</li>
                <li style="padding:8px 0;">‚óã KPI √©quipe calcul√©s</li>
                <li style="padding:8px 0;">‚óã Cr√©er une s√©ance de coaching</li>
                <li style="padding:8px 0;">‚óã Fixer des objectifs</li>
                <li style="padding:8px 0;">‚óã Classement fonctionnel</li>
              </ul>
            </div>
            <div class="tip">
              <span class="tip-icon">üéâ</span>
              <div class="tip-content"><strong>Phase 8 termin√©e !</strong><br>Les coachs peuvent maintenant suivre leur √©quipe !</div>
            </div>
          </div>
        </article>

      </div>

      <nav class="page-nav">
        <a href="phase7-planning.html" class="page-nav-btn"><span>‚Üê</span><div><div class="page-nav-label">Pr√©c√©dent</div><div class="page-nav-title">Phase 7 - Planning</div></div></a>
        <a href="phase9-mdb.html" class="page-nav-btn"><div style="text-align:right;"><div class="page-nav-label">Suivant</div><div class="page-nav-title">Phase 9 - MDB</div></div><span>‚Üí</span></a>
      </nav>
    </main>
  </div>

  <script>
    const STORAGE_KEY='suprealty_progress',PHASE_ID='phase8',TOTAL_STEPS=14;
    function loadProgress(){try{return JSON.parse(localStorage.getItem(STORAGE_KEY)||'{}')}catch{return{}}}
    function saveProgress(p){localStorage.setItem(STORAGE_KEY,JSON.stringify(p))}
    function updateUI(){const progress=loadProgress(),pp=progress[PHASE_ID]||{steps:{}},cc=Object.values(pp.steps||{}).filter(Boolean).length;document.getElementById('progress-text').textContent=cc+'/'+TOTAL_STEPS+' √©tapes';document.getElementById('progress-fill').style.width=(cc/TOTAL_STEPS*100)+'%';document.querySelectorAll('.step').forEach(s=>{const n=s.dataset.step,done=pp.steps&&pp.steps[n],cb=s.querySelector('.step-checkbox');if(done){s.classList.add('completed');cb&&cb.classList.add('checked')}else{s.classList.remove('completed');cb&&cb.classList.remove('checked')}});updateSidebar(pp)}
    function updateSidebar(pp){const nav=document.getElementById('sidebar-nav');nav.innerHTML='';for(let i=1;i<=TOTAL_STEPS;i++){const s=document.querySelector('.step[data-step="'+i+'"]'),t=s?s.querySelector('.step-info h3').textContent:'√âtape '+i,done=pp.steps&&pp.steps[i],li=document.createElement('li');li.className='sidebar-nav-item'+(done?' completed':'');li.innerHTML='<span class="sidebar-nav-number">'+i+'</span><span style="flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">'+t+'</span>';li.onclick=()=>document.querySelector('.step[data-step="'+i+'"]').scrollIntoView({behavior:'smooth'});nav.appendChild(li)}}
    function toggleStep(el){document.querySelectorAll('.step.open').forEach(s=>{if(s!==el)s.classList.remove('open')});el.classList.toggle('open')}
    function toggleCheckbox(n){const p=loadProgress();if(!p[PHASE_ID])p[PHASE_ID]={steps:{}};p[PHASE_ID].steps[n]=!p[PHASE_ID].steps[n];saveProgress(p);updateUI()}
    document.querySelectorAll('.step-header').forEach(h=>h.addEventListener('click',e=>{if(e.target.closest('.step-checkbox'))return;toggleStep(h.closest('.step'))}));
    document.querySelectorAll('.step-checkbox').forEach(c=>c.addEventListener('click',e=>{e.stopPropagation();toggleCheckbox(c.dataset.step)}));
    updateUI();
  </script>
</body>
</html>
